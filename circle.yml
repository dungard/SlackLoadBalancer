machine:
  services:
    - docker
  java:
    version: openjdk8  

environment:
  RABBIT_MASTER: localhost  
    
dependencies:
  pre:
    - docker pull harbur/rabbitmq-cluster:latest
    - export DEBIAN_FRONTEND=noninteractive
    - export DEBIAN_PRIORITY=critical
    - sudo -E apt-get -qy update
    - sudo -E apt-get -qy -o "Dpkg::Options::=--force-confdef" -o "Dpkg::Options::=--force-confold" upgrade
    - sudo -E apt-get -qy autoclean
    - sudo apt-get install docker
    - pip install docker-compose
    
test:    
    pre:
      - docker swarm init
    
    override:
      - chmod +x dockersetup.sh
      - ./dockersetup.sh